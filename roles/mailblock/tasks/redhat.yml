# Check if Python 2.7 is already installed
- name: Does Python 2.7 exist?
  stat: path=/usr/bin/python2.7
  register: installed_python
# Check if Setuptools 2.7 is already installed
- name: Does Setuptools 2.7 exist?
  stat: path=/usr/bin/easy_install-2.7
  register: installed_setuptools
# Check if Pip 2.7 is already installed
- name: Does Pip 2.7 exist?
  stat: path=/usr/bin/pip2.7
  register: installed_pip

# If we don't have Python 2.7, go download and install it
- name: Download Python 2.7
  get_url: url=https://www.python.org/ftp/python/2.7.7/Python-2.7.7.tar.xz
           dest=/tmp/
  when: installed_python.stat.exists == false
- name: Extract Python 2.7
  command: tar -xf /tmp/Python-2.7.7.tar.xz chdir=/tmp
  when: installed_python.stat.exists == false
- name: Configure Python 2.7
  shell: chdir=/tmp/Python-2.7.7 ./configure --prefix=/usr --enable-unicode=ucs4 --enable-shared LDFLAGS="-Wl,-rpath /usr/lib"
  when: installed_python.stat.exists == false
- name: Make and Install Python 2.7
  shell: chdir=/tmp/Python-2.7.7 make && make altinstall
  when: installed_python.stat.exists == false
- name: Download Setuptools
  get_url: url=https://bitbucket.org/pypa/setuptools/raw/bootstrap/ez_setup.py
           dest=/tmp/ez_setup.py
  when: installed_setuptools.stat.exists == false
- name: Install Setuptools for Python 2.7
  command: python2.7 /tmp/ez_setup.py
  when: installed_setuptools.stat.exists == false
- name: Install Pip for Python 2.7
  command: easy_install-2.7 pip
  when: installed_pip.stat.exists == false
